/***
Схема БД состоит из четырех таблиц:
Product(maker, model, type)
PC(code, model, speed, ram, hd, cd, price)
Laptop(code, model, speed, ram, hd, price, screen)
Printer(code, model, color, type, price)
Таблица Product представляет производителя (maker), номер модели (model) и тип ('PC' - ПК, 'Laptop' - ПК-блокнот или 'Printer' - принтер).
Предполагается, что номера моделей в таблице Product уникальны для всех производителей и типов продуктов. 
В таблице PC для каждого ПК, однозначно определяемого уникальным кодом – code, 
указаны модель – model (внешний ключ к таблице Product), скорость - speed (процессора в мегагерцах),
объем памяти - ram (в мегабайтах), размер диска - hd (в гигабайтах), скорость считывающего устройства - cd (например, '4x') и цена - price.
Таблица Laptop аналогична таблице РС за исключением того, что вместо скорости CD содержит размер экрана -screen (в дюймах). 
В таблице Printer для каждой модели принтера указывается, является ли он цветным - color ('y', если цветной),
тип принтера - type (лазерный – 'Laser', струйный – 'Jet' или матричный – 'Matrix') и цена - price.
***/

/***
Задание: 14 (Serge I: 2012-04-20)
Найти производителей, которые выпускают более одной модели, при этом все выпускаемые производителем модели являются продуктами одного типа.
Вывести: maker, type

SELECT p.maker, max(p.type )
FROM Product p
GROUP BY p.maker
HAVING COUNT(DISTINCT p.type) = 1 and COUNT(DISTINCT p.model)>1


Задание: 25 (Serge I: 2003-02-14)
Найдите производителей принтеров, которые производят ПК с наименьшим объемом RAM и с самым быстрым процессором среди всех ПК, имеющих наименьший объем RAM. Вывести: Maker
SELECT DISTINCT maker
FROM Product p,
     PC,
     (SELECT max(PC.speed) speed,
             min(minram.val) minram
      FROM PC,
           (SELECT min(ram) val
            FROM PC
           ) minram
      WHERE PC.ram = minram.val
     ) values1
WHERE p.model = PC.model and
      PC.speed = values1.speed and
      PC.ram = values1.minram and
      p.maker in (SELECT maker
                   FROM Product p2
                  WHERE p2.type = 'Printer');

Задание: 65 (Serge I: 2009-08-24)
Пронумеровать уникальные пары {maker, type} из Product, упорядочив их следующим образом:
- имя производителя (maker) по возрастанию;
- тип продукта (type) в порядке PC, Laptop, Printer.
Если некий производитель выпускает несколько типов продукции, то выводить его имя только в первой строке;
остальные строки для ЭТОГО производителя должны содержать пустую строку символов (''). 
WITH dsProd AS
(SELECT DISTINCT p.maker,
       p.type,
       IIF(p.type = 'PC',1, IIF(p.type = 'Laptop',2,3)) sort
FROM Product p
),
dsRes AS
(SELECT row_number() over(ORDER BY maker, sort) num,
       row_number() over(partition BY maker ORDER BY maker, sort) numPar,
       maker,
       type
 FROM dsProd
)
SELECT num, IIF(numPar = 1,maker,''), type
FROM dsRes;
***/
